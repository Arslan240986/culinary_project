function addComment(e){var t=document.getElementById(e),n=document.querySelector(".formReview").getAttribute("action");let o=$("input[name=csrfmiddlewaretoken]").val();document.contains(document.getElementById("replay_form"))&&document.getElementById("replay_form").remove(),t.insertAdjacentHTML("afterEnd",`<form id="replay_form" action="${n}" method="post" class="ui form input_background mt-10 ml-40">\n            <input type="hidden" name="csrfmiddlewaretoken" value="${o}">\n            <textarea name="text" cols="40" rows="2" maxlength="5000" required="" id="id_text"></textarea>\n            <input type="hidden" name="parent" value="${e}">\n            <div class="ui two buttons"><button onclick="removeCommentForm()" class="ui inverted red button mt-10">Закрыть</button>\n            <button type="submit" class="ui inverted green button mt-10 child_comment_buttons">ДОБАВИТЬ КОММЕНТАРИЙ</button></div></form>`),$(".child_comment_buttons").click(function(e){e.preventDefault();let t=$("textarea[id=id_text]").val(),a=$("input[name=parent]").val();$.ajax({type:"POST",url:n,data:{parent:a,text:t,csrfmiddlewaretoken:o},dataType:"json",success:function(e){document.contains(document.querySelector(".ui.positive.message"))&&document.querySelector(".ui.positive.message").remove(),e.status&&($("#replay_form").before('<div class="ui positive message">\n                            <i class="close icon"></i>\n                            <div class="header">\n                                Спасибо за участие\n                            </div>\n                            <p>Ваш комментарий принят после прохождения модерации будет добавлен на сайт</p>\n                        </div>'),$(".message .close").on("click",function(){$(this).closest(".message").transition("fade")})),$("textarea[id=id_text]").val("")},error:function(e,t){console.log(e.responseText)}})})}function removeCommentForm(){document.getElementById("replay_form").remove()}$(document).ready(function(){let e=!1;$(".cmt_btn").click(function(){!1===e?($(this).next(".comment-box").show("slow"),$(".comment-box").scrollTop($(".comment-box").prop("scrollHeight")),e=!0):($(this).next(".comment-box").hide("slow"),e=!1)}),$(window).width()<768?$(".ui.thumbs").popup({on:"click"}):$(".ui.thumbs").popup(),$("#meal_like_button").on("click",function(e){e.preventDefault();var t=$(this).attr("datatype");const n=$("#like_form").attr("action");let o=$("input[name=csrfmiddlewaretoken]").val();$.ajax({type:"POST",url:n,data:{dish_id:t,csrfmiddlewaretoken:o},dataType:"json",success:function(e){e.user_not_login||(h=$(".meal_total_likes").html(e.form),"Like"==e.is_liked?($("#meal_like_button").removeClass("up"),$("#meal_like_button").addClass("down"),$("#meal_like_button").attr("data-content","Передумал"),console.log()):"Unlike"==e.is_liked&&($("#meal_like_button").removeClass("down"),$("#meal_like_button").addClass("up"),$("#meal_like_button").attr("data-content","Нравится")))},error:function(e,t){console.log("error in like",e.responseText)}})}),$(document).on("click",".add_dishes",function(e){e.preventDefault();var t=$(".meal_id").val();const n=$(".need_change").attr("action");let o=$("input[name=csrfmiddlewaretoken]").val();$.ajax({type:"POST",url:n,data:{id:t,csrfmiddlewaretoken:o},dataType:"json",success:function(e){var t=e.dish_added;t?($(".subscribe_div_add").removeClass("active"),$(".dish_book_count").html(e.count),$(".add_dishes").val("в мою кулинарную книгу")):($(".subscribe_div_add").addClass("active"),$(".dish_book_count").html(e.count),$(".add_dishes").val("в кулинарной книге"))},error:function(e,t){console.log("drugoy",e.responseText)}})}),$(".comment_button").click(function(e){e.preventDefault();const t=$(".formReview").attr("action");let n=$("input[name=csrfmiddlewaretoken]").val(),o=$("textarea[id=id_text]").val();$.ajax({type:"POST",url:t,data:{text:o,csrfmiddlewaretoken:n},dataType:"json",success:function(e){document.contains(document.querySelector(".ui.positive.message"))&&document.querySelector(".ui.positive.message").remove(),e.status&&($(".formReview").before('<div class="ui positive message">\n                        <i class="close icon"></i>\n                        <div class="header">\n                            Спасибо за участие\n                        </div>\n                        <p>Ваш комментарий принят после прохождения модерации будет добавлен на сайт</p>\n                    </div>'),$(".message .close").on("click",function(){$(this).closest(".message").transition("fade")})),$("textarea[id=id_text]").val("")},error:function(e,t){console.log(e.responseText)}})})});var global_val_for_visibility_msg=$(".custom_comment").length;$(document).ready(()=>{$(".get_another_number").click(e=>{const t=$(e.target).attr("data-href-template");global_val_for_visibility_msg+=5,$.ajax({type:"GET",url:`${t}/${global_val_for_visibility_msg}/`,success:function(e){const t=e.new_data;$(".get_another_number").addClass("d_none"),$(".ui.active.centered.inline.black.loader").removeClass("d_none"),setTimeout(function(){var n=Object(),o=Object();$(".ui.active.centered.inline.black.loader").addClass("d_none"),t.map(e=>{var t=`<a class="avatar" href="#"><img src="${e.user_avatar}"></a>`,a=`<div class="content">\n                                                        <a class="author" href="${e.user_personal_page}">${e.user_name}</a>\n                                                        <div class="metadata">\n                                                            <span class="date">${e.created}</span>\n                                                        </div>\n                                                        <div class="text">\n                                                        ${e.text}\n                                                        </div>\n                                                        <div id="${e.id}" class="actions">\n                                                            <a class="ui inverted green mini button" onclick="addComment(${e.id})">Ответить</a>\n                                                        </div>\n                                                    </div> `;if(2==e.level){var s=`<div class="content">\n                                                        <a class="author">${e.user_name}</a>\n                                                        <div class="metadata">\n                                                            <span class="date">${e.created}</span>\n                                                        </div>\n                                                        <div class="text">\n                                                        ${e.text}\n                                                        </div>\n                                                    </div> `,i=document.createElement("div");i.setAttribute("class","comment custom_comment"),i.innerHTML=t,i.innerHTML+=s,n[e.id]=i}else if(1==e.level){i=document.createElement("div");if(i.setAttribute("class","comment custom_comment"),i.innerHTML=t,i.innerHTML+=a,n){var c=document.createElement("div");for(var r in c.setAttribute("class","comments"),n)c.append(n[r]);i.append(c)}o[e.id]=i,n={}}else if(0==e.level){i=document.createElement("div");if(i.setAttribute("class","comment custom_comment"),i.innerHTML=t,i.innerHTML+=a,o){c=document.createElement("div");for(var r in c.setAttribute("class","comments"),o)c.append(o[r]);i.append(c),o={}}$(".comment-box").scrollTop($(".custom_comment").first().prop("scrollHeight")),$(".comment.custom_comment").first().before(i)}}),e.load_more.load_more&&$(".get_another_number").removeClass("d_none")},1e3)},error:function(e){console.log("error",e)}})})});